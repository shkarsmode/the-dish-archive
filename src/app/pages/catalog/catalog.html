<main class="catalog-page">
    <!-- Hero Section -->
    <section class="hero" aria-label="–ó–∞–≥–æ–ª–æ–≤–æ–∫">
        <div class="hero-inner">
            <span class="hero-greeting">{{ greeting().emoji }} {{ greeting().text }}, –ë—É–ª–∫—ñ–Ω–∞!</span>
            <h1 class="hero-title">–ö—É–ª—ñ–Ω–∞—Ä–Ω–∞<br>–∫–Ω–∏–≥–∞</h1>
            <p class="hero-subtitle">
                {{ greeting().suggestion }} –£–ª—é–±–ª–µ–Ω—ñ —Ä–µ—Ü–µ–ø—Ç–∏, –∑—ñ–±—Ä–∞–Ω—ñ –∑ —Ç—É—Ä–±–æ—Ç–æ—é.
            </p>
            <button class="random-recipe-button" (click)="goToRandomDish()" [class.spinning]="isSpinning()">
                <span class="material-symbols-outlined random-icon">casino</span>
                <span>–í–∏–ø–∞–¥–∫–æ–≤–∏–π —Ä–µ—Ü–µ–ø—Ç</span>
            </button>
        </div>
    </section>

    <!-- Collection Stats -->
    @if (collectionStats(); as stats) {
        <section class="collection-stats" aria-label="–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ–ª–µ–∫—Ü—ñ—ó">
            <div class="stats-grid">
                <div class="stat-card">
                    <span class="stat-emoji">üìñ</span>
                    <span class="stat-number">{{ stats.totalRecipes }}</span>
                    <span class="stat-desc">—Ä–µ—Ü–µ–ø—Ç—ñ–≤</span>
                </div>
                <div class="stat-card">
                    <span class="stat-emoji">‚è±Ô∏è</span>
                    <span class="stat-number">{{ stats.totalCookingHours }}</span>
                    <span class="stat-desc">–≥–æ–¥–∏–Ω –≥–æ—Ç—É–≤–∞–Ω–Ω—è</span>
                </div>
                <div class="stat-card">
                    <span class="stat-emoji">‚≠ê</span>
                    <span class="stat-number">{{ stats.avgRating }}</span>
                    <span class="stat-desc">—Å–µ—Ä–µ–¥–Ω—è –æ—Ü—ñ–Ω–∫–∞</span>
                </div>
                <div class="stat-card">
                    <span class="stat-emoji">üíñ</span>
                    <span class="stat-number">{{ stats.favoritesCount }}</span>
                    <span class="stat-desc">—É–ª—é–±–ª–µ–Ω–∏—Ö</span>
                </div>
            </div>
        </section>
    }

    <!-- Quick Category Chips -->
    <section class="quick-filters" aria-label="–®–≤–∏–¥–∫—ñ —Ñ—ñ–ª—å—Ç—Ä–∏">
        <div class="quick-filters-inner">
            @for (category of quickCategories; track category) {
                <app-tag-chip
                    [label]="getCategoryLabel(category)"
                    [active]="isCategoryActive(category)"
                    (tagClicked)="toggleQuickCategory(category)" />
            }
        </div>
    </section>

    <!-- Catalog Section -->
    <section class="catalog" id="catalog" aria-label="–ö–∞—Ç–∞–ª–æ–≥ —Å—Ç—Ä–∞–≤">
        <div class="catalog-inner">
            <!-- Toolbar -->
            <div class="toolbar">
                <div class="toolbar-actions">
                    <button
                        class="filter-button"
                        (click)="openFilters()"
                        [class.has-filters]="dishService.hasActiveFilters()">
                        <span class="material-symbols-outlined">tune</span>
                        @if (dishService.hasActiveFilters()) {
                            <span class="filter-badge">
                                <span class="material-symbols-outlined">circle</span>
                            </span>
                        }
                    </button>
                    <app-sort-dropdown />
                </div>
                <div class="toolbar-search">
                    <app-search-bar />
                </div>
            </div>

            <!-- Active Filters Display -->
            @if (dishService.hasActiveFilters()) {
                <div class="active-filters">
                    <span class="active-filters-label">–ê–∫—Ç–∏–≤–Ω—ñ —Ñ—ñ–ª—å—Ç—Ä–∏:</span>
                    <button class="clear-all-filters" (click)="dishService.resetFilters()">
                        –°–∫–∏–Ω—É—Ç–∏ –≤—Å–µ
                    </button>
                </div>
            }

            <!-- Results Count -->
            @if (!dishService.isLoading()) {
                <div class="results-info">
                    <span class="results-count">
                        {{ dishService.totalFilteredCount() }}
                        {{ dishService.totalFilteredCount() === 1 ? '—Å—Ç—Ä–∞–≤–∞' : '—Å—Ç—Ä–∞–≤' }}
                    </span>
                </div>
            }

            <!-- Dish Grid -->
            @if (dishService.isLoading()) {
                <div class="dish-grid">
                    @for (item of skeletonItems; track $index) {
                        <app-skeleton-card />
                    }
                </div>
            } @else if (dishService.paginatedDishes().length === 0) {
                <app-empty-state
                    icon="search_off"
                    title="–ù—ñ—á–æ–≥–æ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ"
                    description="–°–ø—Ä–æ–±—É–π—Ç–µ –∑–º—ñ–Ω–∏—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –ø–æ—à—É–∫—É –∞–±–æ —Å–∫–∏–Ω—É—Ç–∏ —Ñ—ñ–ª—å—Ç—Ä–∏" />
            } @else {
                <div class="dish-grid">
                    @for (dish of dishService.paginatedDishes(); track dish.id) {
                        <app-dish-card [dish]="dish" />
                    }
                </div>

                <!-- Pagination -->
                @if (dishService.totalPages() > 1) {
                    <nav class="pagination" aria-label="–ù–∞–≤—ñ–≥–∞—Ü—ñ—è –ø–æ —Å—Ç–æ—Ä—ñ–Ω–∫–∞—Ö">
                        <button
                            class="page-button"
                            [disabled]="dishService.currentPage() === 1"
                            (click)="goToPage(dishService.currentPage() - 1)"
                            aria-label="–ü–æ–ø–µ—Ä–µ–¥–Ω—è —Å—Ç–æ—Ä—ñ–Ω–∫–∞">
                            <span class="material-symbols-outlined">chevron_left</span>
                        </button>

                        @for (pageNumber of getPageNumbers(); track $index) {
                            @if (pageNumber === -1) {
                                <span class="page-ellipsis">...</span>
                            } @else {
                                <button
                                    class="page-button"
                                    [class.active]="pageNumber === dishService.currentPage()"
                                    (click)="goToPage(pageNumber)"
                                    [attr.aria-current]="pageNumber === dishService.currentPage() ? 'page' : null"
                                    [attr.aria-label]="'–°—Ç–æ—Ä—ñ–Ω–∫–∞ ' + pageNumber">
                                    {{ pageNumber }}
                                </button>
                            }
                        }

                        <button
                            class="page-button"
                            [disabled]="dishService.currentPage() === dishService.totalPages()"
                            (click)="goToPage(dishService.currentPage() + 1)"
                            aria-label="–ù–∞—Å—Ç—É–ø–Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞">
                            <span class="material-symbols-outlined">chevron_right</span>
                        </button>
                    </nav>
                }
            }
        </div>
    </section>

    <!-- Filter Drawer -->
    <app-filter-drawer #filterDrawer />
</main>
